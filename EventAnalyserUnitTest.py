import unittest
from dummy import analyse_same_element_access, detect_rapid_clicks,transform_data

class TestEventFunctions(unittest.TestCase):

    def setUp(self):
        # Setup any common test data
        self.apikey = "1fI4SxneQu26epS9hNVH9OEyVwwTyAH5V71i4DUJkSG6GaG66NPOfjMWh6rm1c0b"
        self.sessionid = "nvbx439TqxBs1GMf5F1cWwgAAa7k9LUIYvWB1LvCpmGQMSYLsn3ecNhw6dCnk7AAgItDpSsNNICoLqbASSsA"
        with open('data.json', 'r') as file:
            self.json_string = file.read() 
            

    def test_transform_data(self):
        result = transform_data(self.json_string,self.apikey,self.sessionid)
        expected_row = [{'APIKey': '1fI4SxneQu26epS9hNVH9OEyVwwTyAH5V71i4DUJkSG6GaG66NPOfjMWh6rm1c0b', 'SessionId': 'nvbx439TqxBs1GMf5F1cWwgAAa7k9LUIYvWB1LvCpmGQMSYLsn3ecNhw6dCnk7AAgItDpSsNNICoLqbASSsA', 'EventRating': 'good', 'Timestamp_start': 1721847757.7, 'Timestamp_end': 1746847771.15, 'EventData': '[{"isTrusted": true, "altKey": false, "button": 0, "buttons": 0, "clientX": 564.51953125, "clientY": 489.3984375, "ctrlKey": false, "layerX": 564, "layerY": 489, "metaKey": false, "movementX": 0, "movementY": 0, "offsetX": 564.51953125, "offsetY": 489.3984375, "pageX": 564.51953125, "pageY": 489.3984375, "pointerType": "mouse", "screenX": 564.51953125, "screenY": 601.3984375, "shiftKey": false, "element": {"tagName": "P", "id": "id19"}, "x": 564.51953125, "y": 489.3984375, "timestamp": 1738847769516}, {"isTrusted": true, "altKey": false, "button": 0, "buttons": 0, "clientX": 564.51953125, "clientY": 489.3984375, "ctrlKey": false, "layerX": 564, "layerY": 489, "metaKey": false, "movementX": 0, "movementY": 0, "offsetX": 564.51953125, "offsetY": 489.3984375, "pageX": 564.51953125, "pageY": 489.3984375, "pointerType": "mouse", "screenX": 564.51953125, "screenY": 601.3984375, "shiftKey": false, "element": {"tagName": "P", "id": "id1"}, "x": 564.51953125, "y": 489.3984375, "timestamp": 1739847769783}, {"isTrusted": true, "altKey": false, "button": 0, "buttons": 0, "clientX": 574.48828125, "clientY": 294.71484375, "ctrlKey": false, "layerX": 465, "layerY": 16, "metaKey": false, "movementX": 0, "movementY": 0, "offsetX": 441.48828125, "offsetY": 8.71484375, "pageX": 574.48828125, "pageY": 294.71484375, "pointerType": "mouse", "screenX": 574.48828125, "screenY": 406.71484375, "shiftKey": false, "element": {"tagName": "P", "id": "id1"}, "x": 574.48828125, "y": 294.71484375, "timestamp": 1740847770200}, {"isTrusted": true, "altKey": false, "button": 0, "buttons": 0, "clientX": 574.48828125, "clientY": 294.71484375, "ctrlKey": false, "layerX": 465, "layerY": 16, "metaKey": false, "movementX": 0, "movementY": 0, "offsetX": 441.48828125, "offsetY": 8.71484375, "pageX": 574.48828125, "pageY": 294.71484375, "pointerType": "mouse", "screenX": 574.48828125, "screenY": 406.71484375, "shiftKey": false, "element": {"tagName": "P", "id": "id1"}, "x": 574.48828125, "y": 294.71484375, "timestamp": 1741847770366}, {"isTrusted": true, "altKey": false, "button": 0, "buttons": 0, "clientX": 574.48828125, "clientY": 294.71484375, "ctrlKey": false, "layerX": 465, "layerY": 16, "metaKey": false, "movementX": 0, "movementY": 0, "offsetX": 441.48828125, "offsetY": 8.71484375, "pageX": 574.48828125, "pageY": 294.71484375, "pointerType": "mouse", "screenX": 574.48828125, "screenY": 406.71484375, "shiftKey": false, "x": 574.48828125, "y": 294.71484375, "timestamp": 1742847770501}, {"isTrusted": true, "altKey": false, "button": 0, "buttons": 0, "clientX": 574.48828125, "clientY": 294.71484375, "ctrlKey": false, "layerX": 465, "layerY": 16, "metaKey": false, "movementX": 0, "movementY": 0, "offsetX": 441.48828125, "offsetY": 8.71484375, "pageX": 574.48828125, "pageY": 294.71484375, "pointerType": "mouse", "screenX": 574.48828125, "screenY": 406.71484375, "shiftKey": false, "x": 574.48828125, "y": 294.71484375, "timestamp": 1743847770684}, {"isTrusted": true, "altKey": false, "button": 0, "buttons": 0, "clientX": 574.48828125, "clientY": 294.71484375, "ctrlKey": false, "layerX": 465, "layerY": 16, "metaKey": false, "movementX": 0, "movementY": 0, "offsetX": 441.48828125, "offsetY": 8.71484375, "pageX": 574.48828125, "pageY": 294.71484375, "pointerType": "mouse", "screenX": 574.48828125, "screenY": 406.71484375, "shiftKey": false, "x": 574.48828125, "y": 294.71484375, "timestamp": 1744847770834}, {"isTrusted": true, "altKey": false, "button": 0, "buttons": 0, "clientX": 574.48828125, "clientY": 294.71484375, "ctrlKey": false, "layerX": 465, "layerY": 16, "metaKey": false, "movementX": 0, "movementY": 0, "offsetX": 441.48828125, "offsetY": 8.71484375, "pageX": 574.48828125, "pageY": 294.71484375, "pointerType": "mouse", "screenX": 574.48828125, "screenY": 406.71484375, "shiftKey": false, "x": 574.48828125, "y": 294.71484375, "timestamp": 1745847770984}, {"isTrusted": true, "altKey": false, "button": 0, "buttons": 0, "clientX": 574.48828125, "clientY": 294.71484375, "ctrlKey": false, "layerX": 465, "layerY": 16, "metaKey": false, "movementX": 0, "movementY": 0, "offsetX": 441.48828125, "offsetY": 8.71484375, "pageX": 574.48828125, "pageY": 294.71484375, "pointerType": "mouse", "screenX": 574.48828125, "screenY": 406.71484375, "shiftKey": false, "x": 574.48828125, "y": 294.71484375, "timestamp": 1746847771150}]'}]
        self.assertEqual(result, expected_row)


if __name__ == '__main__':
    unittest.main()
